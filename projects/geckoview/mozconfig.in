[% IF !c("var/firefox-browser") -%]
. $topsrcdir/[% c("var/mozconfig_file") %]
[% ELSE -%]
  ac_add_options --enable-application=mobile/android
[% END -%]

# Make sure to disable bootstrap also when running online builds for dependency
# updates.
ac_add_options --disable-bootstrap

CC="clang"
CXX="clang++"
ac_add_options --enable-linker=lld

ac_add_options --with-android-sdk=$ANDROID_HOME
ac_add_options --with-android-ndk=$ANDROID_NDK_HOME
ac_add_options --with-gradle=$GRADLE_HOME/bin/gradle

ac_add_options --with-java-bin-path=/usr/lib/jvm/java-1.17.0-openjdk-amd64/bin

mk_add_options MOZ_PARALLEL_BUILD=[% c("num_procs") %]
export MOZ_INCLUDE_SOURCE_INFO=1
export MOZ_SOURCE_REPO="[% c('var/gitlab_project') %]"
export MOZ_SOURCE_CHANGESET=[% c("var/git_commit") %]

ac_add_options --enable-update-channel=[% c("var/variant") %]

[% IF c("var/dev_artifacts") -%]
  ac_add_options --enable-tests
  # Necessary for package-tests step which expects dist/bin/jsapi-tests to exist.
  ac_add_options --enable-js-shell
[% END -%]
